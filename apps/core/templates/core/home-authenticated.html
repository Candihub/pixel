{% extends "base.html" %}

{% load i18n %}

{% block content %}
  <h2>{% trans "Welcome to Pixel" %}</h2>

  <div class="grid-x">
    <div class="cell">
      <div id="pixels-by-species" style="height: 500px"></div>
    </div>

    <div class="cell">
      <div id="omicsarea-tree" class="unstriped"></div>
    </div>

    <div class="cell">
      <div id="pixels-by-omics-area" style="height: 500px"></div>
    </div>

    <div class="cell">
      <div id="pixels-by-omics-unit-type" style="height: 500px"></div>
    </div>

    <div class="cell">
      <div id="count-tags" style="height: 400px;"></div>
    </div>

    <div class="cell">
      <p class="google-title">
        {% trans "Who are the Pixelers?" %}
      </p>
      <table>
        <thead>
          <tr>
            <th>{% trans "Name" %}</th>
            <th>{% trans "Email" %}</th>
            <th>{% trans "Joined on" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for pixeler in pixelers %}
          <tr>
            <td>{{ pixeler.first_name }} {{ pixeler.last_name }}</td>
            <td>
              <a href="mailto:{{ pixeler.email }}">{{ pixeler.email }}</a>
            </td>
            <td>{{ pixeler.date_joined|date:'Y-m-d' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock content %}

{% block javascript %}
  <script type="text/javascript" src="//www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['corechart', 'orgchart']});
    google.charts.setOnLoadCallback(drawCharts);

function drawCharts() {
  var pixelBySpecies = new google.visualization.PieChart(
    document.getElementById('pixels-by-species')
  );
      pixelBySpecies.draw(
        google.visualization.arrayToDataTable(
          {{ pixels_by_species.data|safe }},
          true
        ),
        { title: '{{ pixels_by_species.title }}' }
      );

      var omicsareaTree = new google.visualization.OrgChart(
        document.getElementById('omicsarea-tree')
      );
      omicsareaTree.draw(
        google.visualization.arrayToDataTable(
          {{ omics_area_tree.data|safe }},
          true
        ),
        { title: '{{ omics_area_tree.title }}' }
      );

      var pixelsByOmicsUnitType = new google.visualization.PieChart(
        document.getElementById('pixels-by-omics-unit-type')
      );
      pixelsByOmicsUnitType.draw(
        google.visualization.arrayToDataTable(
          {{ pixels_by_omics_unit_type.data|safe }},
          true
        ),
        { title: '{{ pixels_by_omics_unit_type.title }}' }
      );

      var pixelsByOmicsArea = new google.visualization.PieChart(
        document.getElementById('pixels-by-omics-area')
      );
      pixelsByOmicsArea.draw(
        google.visualization.arrayToDataTable(
          {{ pixels_by_omics_area.data|safe }},
          true
        ),
        { title: '{{ pixels_by_omics_area.title }}' }
      );

      var countTags = new google.visualization.ColumnChart(
        document.getElementById('count-tags')
      );
      countTags.draw(
        google.visualization.arrayToDataTable(
          {{ count_tags.data|safe }},
          true
        ),
        {
          title: '{% trans count_tags.title %}',
          legend: { position: 'none' },
          hAxis: {
            title: '{% trans "Tags" %}'
          },
          vAxis: {
            title: '{% trans "Number of tags" %}'
          }
        }
      );
}
  </script>
{% endblock javascript %}
